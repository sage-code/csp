<!DOCTYPE html>
<html lang="en" data-bs-theme="dark"><head>
  <meta charset="utf-8">
  <meta name="description" content="Introduction to Ruby repetitive statements.">
  <meta name="author" content="Elucian Moise">
  <meta name="keywords" content="ruby, language, syntax, repetition, loop, statement">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Website title -->
  <title>Ruby Repetition</title>  

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
  <!-- Icon -->
  <link rel="icon" type="image/png"  href="https://sagecode.net/images/favicon.ico">  
  <!-- Prism Highlighter -->
  <link rel="stylesheet" href="https://sagecode.net/prism.css">
  <script src="https://sagecode.net/prism.js"></script>
  <!-- custom css -->
  <link rel="stylesheet" href="https://sagecode.net/sage.css">
  </head>
<body>

<div class="container">
        
<!-- header -->
<header class="row">
    <div class="col">
        <a href="https://sagecode.net"><img src="https://sagecode.net/images/sage-logo.svg" alt="Sage-Code Laboratory" height="80"/></a>
    </div>  
    <div class="col  bottom-right">
        <a href="index.html#ruby-index" rel="nofollow">index</a>&lt;--
    </div>
</div>
    

<hr>

<h2>Ruby Repetition</h2>

<div class="alert alert-secondary shadow-sm">
This is the second most important statement in a programming language. With decisions and repetitions you can resolving a problems. There are languages that do not have these statements: XML, HTML, and CSS.&nbsp; We say these languages are not "<em>Turing complete</em>".&nbsp;
</div>

<h2>While loop</h2>
<p>A repetitive statement is often called loop. Diverse kind of loops are controlled by different methods. A loop can repeat forever if you are not careful. This may be an error made by beginners. If you make this error, do not be intimidated. Just press Ctrl+C to kill your process.</p>

<div align="center">
  <img src="../images/while.svg" alt="decision" width="520" 
       class="img-fluid protect rounded shadow border" >    
  <p>while loop diagram</p>
</div>  

<h4>Example:</h4>
<p>While loop is executed until a control condition become false.</p>
<pre><code class="language-ruby line-numbers"># enter number between 1 and 5
begin
  print "how many? (1..5):"
  $count = gets.to_i
end while $count &gt; 5

# early termination 
abort("done") if $count == 0 

n = 0 #control variable

# wile loop with control variable
while n &lt; $count do
  print n += 1, ","
end

exit(0)   # early termination
puts "ok" # dead code</code></pre>
<p><b>Note:&nbsp;</b>A lot is happening in this short example:</p>
<ol>
<li>I have used "while" keyword in ways to create loops,&nbsp;</li>
<li>First is actually a block with "while" augment,</li>
<li>Second is the proper loop controlled by variable "n",</li>
<li>There are two early exit points: abort() and exit(),</li>
<li>The "print" statement is similar to "puts" except it does not add new line.</li>
</ol>
<p><b>Homework:</b>&nbsp;open this example live and run-it 2 times:&nbsp;<a href="https://repl.it/@elucian/ruby-while-loop" target="_blank" rel="noopener noreferrer">while loop</a></p>
<ul>
<li>first time use a correct number: 5,</li>
<li>second time use 9: it will ask again,</li>
<li>no enter 0: this will abort the program.</li>
</ul>

<h2>Loop do</h2>

<p>This is known in other languages like: do-while loop. It execute at least one time and it repeats infinite number of times if there is no break condition. You must use expression "break if" before the end of block so that the repetition can stop.</p>

<div align="center">
  <img src="img/loop-do.svg" alt="do-while" width="420" class="img-fluid protect rounded shadow border" >    
  <p>loop do</p>
</div> 

<h4>Pattern</p>

<pre><code class="language-ruby line-numbers">
loop do

 # code to be executed

break if Boolean_Expression

end
</code></pre>

<h4>Example:</h4>

<pre><code class="language-ruby line-numbers">
def nearest_larger(arr, idx)
  diff = 1
  loop do
    left = idx - diff
    right = idx + diff

    if (left >= 0) && (arr[left] > arr[idx])
      return left
    elsif (right < arr.length) && (arr[right] > arr[idx])
      return right
    elsif (left < 0) && (right >= arr.length)
      return nil
    end

    diff += 1
  end
end
nearest_larger([2,4,3,8], 1)
</code></pre> 

<h2>Until loop</h2>
<p>The&nbsp;<em>until</em>&nbsp;statement is similar to the&nbsp;while&nbsp;statement in functionality. Unlike the&nbsp;while&nbsp;statement, the code block for the&nbsp;until loop will execute as long as the control condition evaluates to false. When this condition become true the loop will stop.</p>

<div align="center">
  <img src="img/until-do.svg" alt="do-while" width="460" class="img-fluid protect rounded shadow border" >    
  <p>Until Diagram</p>
</div> 

<h4>Example:</h4>
<p>This example should look familiar by now. It is similar with previous one.</p>
<pre><code class="language-ruby line-numbers"># execute at least once
begin
  print "iterations (1..8):"
  $count = gets.to_i
end until $count &lt;= 8 

# early termination 
abort("Abort!") if $count &lt;= 0 

n = $count #control variable

# until loop with control variable
until n == 0 do
  print n
  print "," if n &gt; 1
  n -= 1;
end

puts "\nDone!" # finish</code></pre>
<p><b>Note:&nbsp;</b>In my opinion "until" is redundant, but in Ruby you can do same thing in many ways. In previous example you can observe the loop display numbers in reverse order and the last comma is not display.</p>
<p><b>Homework:</b>&nbsp;run this example:&nbsp;<a href="https://repl.it/@elucian/ruby-until-loop" target="_blank" rel="noopener noreferrer">until loop</a></p>
<p><b>Single line:</b></p>
<p>You can create a loop in a single statement. Your program will look very strange for someone who do not understand Ruby. The next code fragment will read input values until the value is right:</p>
<pre><code class="language-ruby line-numbers">print "enter a value between (1..5)";
a = 0; 
a = gets.to_i until (1..5).include?(a) </code></pre>
<p><b>Note:&nbsp;</b>Previous example accept input and validate against range (1..5). If the value you enter is in range the statement terminates otherwise is waiting for the next input until you get it right.</p>

<h2>For loop</h2>
<p>This kind of loop is sometimes called iteration. It will repeat a statement or a group of statements of specific number of times. It is controlled by a range of values. Same loop can also iterate over items of a collection.</p>
<h4>Example:</h4>
<pre><code class="language-ruby line-numbers"># read one number in range
print "iterations (0..10):"
x = gets.to_i until (0..10) === x

# print a list of numbers
print "\nAscending:"
for n in 0..x do
    print n
    print "," if n &lt; x
end

print "\nIn reverse:"
# print a list of numbers in revers
for n in -x..0 do
    print -n
    print "," if n &lt; 0
end

puts "\nDone!" # finish</code></pre>
<p><b>Note:</b></p>
<ol>
<li>Range notation include both limits,</li>
<li>Range can start from negative number,</li>
<li>Reverse range do not exist actually,</li>
<li>Keyword "do" is optional but is a good practice to use it.</li>
</ol>
<p><b>Homework:&nbsp;</b>open example live and run it:&nbsp;<a href="https://repl.it/@elucian/ruby-for-range" target="_blank" rel="noopener noreferrer">for range</a></p>
<h2>Array traversal</h2>
<p>You can use "for" loop to visit all elements from an array. Actually this kind of loop is very similar with previous. The only difference is the loop is controlled by the collection. When all elements of collection are visited the loop will stop.</p>
<h4>Example:</h4>
<pre><code class="language-ruby line-numbers"># read one number in range
print "iterations (0..10):"
x = gets.to_i until (0..10) === x

array = (0..x).to_a # create an array
print "array = ", array

# for loop visitor pattern
print "\nFor loop: "
for e in array do
  print e," " 
end</code></pre>
<p><b>Note:&nbsp;</b>In this example:</p>
<ul>
<li>we use a range and method "to_a" that will create and initialize an array object,</li>
<li>statement "print" is intelligent, it can print an array using notation: [ 0,&nbsp; 1, 2, &hellip;],</li>
<li>inside the loop we print the elements one by one separated by space.</li>
</ul>
<p><b>Homework:&nbsp;</b>Open this example live and run it:&nbsp;<a href="https://repl.it/@elucian/ruby-foreach" target="_blank" rel="noopener noreferrer">for-each</a></p>

<h2>Interruptions</h2>
<p>If you are familiar with other computer languages you should know any loop statement can be interrupted earlier. This is done with additional keywords that can be used with conditionals to control nested loops or complex situations:</p>
<ul>
<li>break: stop execution of inner most loop,</li>
<li>next: jumps to the next iteration of the most internal loop,</li>
<li>redo: restarts this iteration of the most internal loop,</li>
<li>retry: can be used to reset the iterator of most internal loop.</li>
</ul>

<div align="center">
  <img src="../images/for-loop.svg" alt="continue" width="640" class="img-fluid protect rounded shadow border" >    
  <p>Loop Intreruptions</p>
</div>  

<p><b>Example</b></p>
<pre><code class="language-ruby line-numbers"># print only odd numbers
puts "odd:"
for x in 1..10 do
  next if x % 2 == 0
  print x," " # 1 3 5 7 9
end

# print only even numbers
puts
puts "even:"
for x in 1..10 do
  next if x % 2 != 0
  print x," "  # 2 4 6 8 10
end</code></pre>
<h4>Notes:</h4>
<ol>
<li>operation (x % 2) will return zero if 2 is divisor of x,</li>
<li>this program do not require input and will produce same output every time is run.</li>
</ol>
<p><b>Output:&nbsp;</b>To verify the output you must run it:&nbsp;<a href="https://repl.it/@elucian/ruby-next-iteration" target="_blank" rel="noopener noreferrer">next iteration</a></p>

<hr>

<p><b>Read next:</b>
<a href="methods.html">Methods</a></p>

<!-- Footer -->
<footer class="footer">
  <div class="footer-copyright text-center"></div>
</footer>


</div>


</body>
</html>