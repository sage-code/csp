<!DOCTYPE html>
<html lang="en" data-bs-theme="dark"><head>
  <meta charset="utf-8">
  <meta name="description" content="Understend Scala control flow statements.">
  <meta name="author" content="Elucian Moise">
  <meta name="keywords" content="sage, code, scala, control, flow, decision, repetition, while, loop">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Website title -->
  <title>Scala Control</title>  

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
  <!-- Icon -->
  <link rel="icon" type="image/png"  href="https://sagecode.net/images/favicon.ico">  
  <!-- Prism Highlighter -->
  <link rel="stylesheet" href="https://sagecode.net/prism.css">
  <script src="https://sagecode.net/prism.js"></script>
  <!-- custom css -->
  <link rel="stylesheet" href="https://sagecode.net/sage.css">
  </head>
<body>

<div class="container">
        
<!-- header -->
<header class="row">
    <div class="col">
        <a href="https://sagecode.net"><img src="https://sagecode.net/images/sage-logo.svg" alt="Sage-Code Laboratory" height="80"/></a>
    </div>  
    <div class="col  bottom-right">
        <a href="index.html#lang-index" rel="nofollow">index</a>&lt;--
    </div>
</div>
    

<hr>

<h1>Scala Control Flow</h1>

<div class="alert alert-secondary shadow-sm">
Control flow statements are inherited from structured programming. A program can be simple, linear where statements are executed one after another from top to bottom. For complex programs, we need a to alter this order using control structures. We can create branches, jumps forward or backwords and repetitive statements. 
</div>

<p>Scala is a multi-paradigm language. It has Object Oriented features, Functional features and also structured programming features. This include the basic control structures you’d expect to find in a structured programming language as follows:</p>

<ul>
<li>Decision statement: if/then/else;</li>
<li>Repetition statement: for loops;</li>
<li>Selection statement: match;</li>
<li>Exception handling: try/catch/finally;</li>
</ul>

<p>There is a lot to cover, take a break, grab a cofee and come back later when you are prepared for the challange. We will explain all these and some more in a single page. Are you ready yet? Ok, start scrolling down and pay attention to details!</p>

<h2>Decision</h2>

<p>A decision is based on a conditional expression that is also known as logical expression. You must understand propositional logic to be able to make correct conditions. Check next diagram to understand the decision workflow.</p>

<div align="center">
  <img src="../images/decision.jpg" alt="decision" srcset="../images/decision.svg" width="460" class="img-fluid protect rounded shadow border" >    
  <p>Decision Diagram</p>
</div>  

<h4>Example:</h4>

<p>In next example we use a condition to create two logical branches. Each branch is contained into a block of code for demo purpose. Second branch will never execute since val is immutable. In real programming, x should be a variable with unknown value. Then any branch could be executed depending on condition value: true or false.</p>

<pre><code class="language-scala">/* Demo the "if" statement */
val x: Int = 0
if (x != 0) {
    // true block
    println("x is not zero")
} else {
    // false block
    println("x is zero")
}
</code></pre>

<h4>Notes:</h4>
<ul>
<li>Decision is represented in Scala using the "if" keyword;</li>
<li>After condition we can start a block statement {...};</li> 
<li>Sometimes second branch "else" is missing;</li> 
<li>Conditional statemen is enclosed in round brackets (...)</li>
</ul>

<h4>Expression:</h4>

<p>In next example we use "if" keyword to create a logical expression. This is not a decision statement but a new way of thinking. Making logical computations is specific to <em>functional programming</em> and is called <em>expression-oriented programming</em> (EOP). To enable this technique Scala "if" can return a response that can be captured using assignment:</p>

<pre><code class="language-scala">// logical expressions using "if" result
val minValue = if (a &lt; b) a else b
val maxValue = if (a &gt; b) a else b

// sometimes there is a way to simplify
val eqValues = if (a == b) true else false
val eq2Vals  = a == b //simplified expression
</code></pre>

<p><b>Note:&nbsp;</b>If you are a veteran programmer, you have probably seen this before. It is called <em>ternary operator</em> in other languages. Ternary operator is most common in C, C++ and Java but not used in Scala.</p>

<pre><code class="language-java">//ternary operator in Java
int max = a >= b ? a : b; 
int min = a >= b ? b : a; 
</code></pre>

<h2>Repetition</h2>

<p>Scala is using "for" keyword to create all kind of repetitive statements. First one we learn is also using Range collection, that is a fast way to generate consecutive equally spaced numbers.</p> 

<div align="center">
  <img src="../images/for-loop.svg" alt="for loop"
       width="500" class="img-fluid protect rounded shadow border" >    
  <p>Iteration Concept</p>
</div> 

<h4>Example 1:</h4>

<p>Next example demonstate a simple loop without branches, controlled by variable "i" that takes value from a range of integers [1..3]. </p>

<pre><code class="language-scala">//demo: for loop with range
object Main {
  def main(args: Array[String]): Unit = {
    for (i &lt;- 1 to 3) {    
      println(s"i= $i")
    }
  }
}
</code></pre>


<h4>Example 2:</h4>

<p>Scala do not have regular break and continue keywords. However it does offer similar functionality through scala.util.control.Breaks. Let's analyze next two fragments of code:</p>

<p><em>Fragment: </em>Simulate the break statement:</p>

<pre><code class="language-scala">//for loop with breaks
breakable {
    for (i &lt;- 1 to 10) {
        println(i)
        if (i > 4) break
    }
}
</code></pre>

<p><em>Fragment: </em> Simulate the continue statement:</p>

<pre><code class="language-scala">//for loop with continue
for (j &lt;- 1 to 10) {
    breakable {
        if (j &lt; 5) 
           break
        else 
           println(j)        
    }
}
</code></pre>

<p><b>Note:</b> that break and breakable aren’t actually keywords; they’re methods in scala.util.control.Breaks. The "break" method is declared as follows to throw an instance of a BreakControl exception when it’s called:</p>

<pre><code class="language-scala">//fragment: for loop with continue
private val breakException = new BreakControl
def break(): Nothing = { throw breakException }
</code></pre>

<p><b>Homework:&nbsp;</b>Let's put all this together into a single example. You can open the example on-line and study. It is available at this location:
<a href="https://repl.it/@elucian/scala-range#main.scala" 
   target="_blank" rel="nofollow noreferrer noopener">scala-range</a></p>

<h4>Example 3:</h4>

<p>How about nested loops? For breaking nested loops is even more complicated. I will post an example on external website repl.it for anyone intrested to study this farther.</p>

<p><b>Optional:&nbsp;</b>Open this example to see how labeled breakable loops are implemented in Scala:
<a href="https://repl.it/@elucian/scala-labels#main.scala" 
   target="_blank" rel="nofollow noreferrer noopener">scala-labels</a></p>

<h2>Loop Filters</h2>

<p>As previous example shows, working with break exceotion is a bit difficult in Scala. Also, exception handling add a bit of drag to your code. A more elegant solution is offered by <em>loop filters</em> also known as <em>guards</em>.</p>

<h4>Syntax:</h4>

<p>Filters can be used with a new "for" syntax that has a block to establish one or more filters. This is the preferred way of writing loops in Scala, to separate the control from the executable block.</p>


<pre><code class="language-scala">//for loop with filter
for {
    control_var &lt;- range_or_source
    if filter_conditional1(control_var)
    if filter_conditional2(control_var)
    ....
    if filter_conditionalN(control_var)
} doSomething(file)
</code></pre>

<h4>Example:</h4>

<p>This example show the old style for loop with one filter condition:</p>

<pre><code class="language-scala">//for loop with filter
for (i &lt;- 1 to 10 if i % 2 == 0) println(i)
</code></pre>

<p>This example show the new style for the same loop (more readable):</p>

<pre><code class="language-scala">//for loop with filter
for { 
    i &lt;- 1 to 10 
    if i % 2 == 0
} println(i)
</code></pre>

<h2>Selection</h2>

<p>Scala has a concept of a <em>match expression</em> to make for a selection statement that we have in most structured programming languages. In the most simple case you can use a match expression</em>like a <em>switch</em> statement.</p>

<div align="center">
  <img src="img/match.svg" alt="match selector"
       width="300" class="img-fluid protect rounded shadow border" >    
  <p>Match Selector</p>
</div> 

<h4>Example:</h4>

<p>In next example we demo pattern matching using a simple loop and random number generator: scala.util.Random to generate 10 random touples.</p>

<pre><code class="language-scala">/* demo for pattern matching */
import scala.util.Random

object Main {
  def main(args: Array[String]): Unit = {
    for (i &lt;- 1 to 10) {
        val x: Int = Random.nextInt(10)     // using match expression   
        val y = x match {
            case 0 => "zero"
            case 1 => "one"
            case 2 => "two"
            case 3 => "three"
            case _ => "other"
        }        
        println(s"($x, $y)")
    } //end for
  } //end main
}
</code></pre>

<h4>Output:</h4>

<p>Every time you run previous example you get a different result. Here is my result:</p>

<pre class="language-output">
(4, other)
(0, zero)
(8, other)
(4, other)
(0, zero)
(3, three)
(0, zero)
(8, other)
(8, other)
(9, other)
</code></pre>

<!--todo explain Pattern Guards 
https://docs.scala-lang.org/tour/pattern-matching.html -->

<h2>Exceptions</h2>

<p>Scala has a try/catch/finally structure like Java. Scala uses the same syntax as the "match expressions" you have just learned above. You can use "case" statements to match different possible exceptions in the catch section of "try" statement.
</p>

<h4>Syntax:</h4>

<p>This statement comes as a complex block with 3 main blocks. The "try" block is the block of code we will protect against errors, the "catch" block is the block for catching different errors. The last block is the "finally" block that executes in any event before control is released to next statement.</p>

<pre><code class="language-scala line-numbers">//syntax pseudocode
try {
    // statements that can throw exceptions
    ...
} 
catch {
    case foo: FooException => handleFooException(foo)
    case bar: BarException => handleBarException(bar)
    ...
    case _: Throwable => println("other exception")
} finally {
    /* unblock some resources:
       closing a database connection
       closing a a file */
    ...
}
</code></pre>

<p><b>More later: </b>I will cover more details about try/catch/finally syntax in our next page. I need to learn more about functional programming and exceptions before I can continue. Thanks for reading so far.</p>

<!-- work in progress-->

<hr>
<p><b>Read next:</b>
<a href="packages.html">Packages</a></p>

<!-- Footer -->
<footer class="footer">
  <div class="footer-copyright text-center"></div>
</footer>
</div>
</body>
</html>